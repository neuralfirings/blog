<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      nyl.io &middot; Random neural firings by Nancy Yi Liang.
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/blog/public/css/poole.css">
  <link rel="stylesheet" href="/blog/public/css/syntax.css">
  <link rel="stylesheet" href="/blog/public/css/lanyon.css">


  <link rel="stylesheet" href="/blog/public/css/nyl.css">
  <link rel="stylesheet" href="/blog/css/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/blog/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Google Fonts -->

  <link href='https://fonts.googleapis.com/css?family=Lato:400,300,100,700,900' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,800' rel='stylesheet' type='text/css'>
</head>


  <body class="theme-base-08 layout-reverse">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p></p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/blog">Home</a>

    

    
    
      
        
      
    
      
        
          
            <a class="sidebar-nav-item" href="/blog/about.html">About</a>
          
        
      
    
      
    
      
        
      
    
      
        
          
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
    
      
        
          
            <a class="sidebar-nav-item" href="/blog/test.html">Test</a>
          
        
      
    

<!--     <a class="sidebar-nav-item" href="/archive/v1.0.0.zip">Download</a>
    <a class="sidebar-nav-item" href="">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.0.0</span> -->
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2015. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <a href="/blog/" title="Home">nyl.io</a>&nbsp;&nbsp;&nbsp;
            <small>Random neural firings by Nancy Yi Liang.</small>
          </h2>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/2015/08/dogfood">
        Dogfood
      </a>
    </h1>

    <span class="post-date">05 Aug 2015</span>

    <blockquote>
  <p>Eating your own dog food, also called dogfooding, is a slang term used to reference a scenario in which a company uses its own product to validate the quality and capabilities of the product. ‚Äî <a href="http://en.wikipedia.org/wiki/Eating_your_own_dog_food">Wikipedia</a></p>
</blockquote>

<p><img src="/content/images/2015/08/dogfood-1.jpg" alt="" /></p>

<p>When I design products, I make an effort to regularly use the products I make. If I write a platform or <a href="http://blog.nyl.io/guidejs/">library</a>, I <a href="http://blog.nyl.io/esp8266-led-using-guide-js/">use it myself</a>. It‚Äôs something so obvious, but surprisingly uncommon.</p>

<h3 id="knowing-the-community">Knowing the Community</h3>

<p>One side effect of eating your own dogfood is that you become a part of the community. You are using the same products, sharing the same goals, and it‚Äôs just easier to connect with your community that way.</p>

<p>Being a part of the community opens you up to a world of insights. They can provide feedback and ideas that you‚Äôd never come across just by yourself.</p>

<h3 id="personalize-the-pain">Personalize the Pain</h3>

<p>Pain avoidance is a great motivator. We can‚Äôt help it. We are evolutionarily wired to avoid things that cause us pain. It‚Äôs how we learn to not stick our hands in the fire even though it looks so pretty.</p>

<p>Taken with the point above (‚ÄúKnowing the Community‚Äù), you aren‚Äôt just solving pain for yourself, but also for your friends. It works for both selfish and unselfish people.</p>

<h3 id="quicker-product-development">Quicker Product Development</h3>

<p>Dogfooding also enables you to develop product at a quicker pace. Rather than talking to customers for every minor tweak or product decision, you can reflect on your own experience, anecdotes and observations from being a part of and interacting with members of the community. It‚Äôs just easier for the left brain to talk with the right brain than to conduct a focus group, and quicker, and easier.</p>

<p>Of course, the flip side is to not get too cocky about all of this. There‚Äôs still a lot that you don‚Äôt know. Move quickly. Remain curious. Confidence is arrogance with a healthy dose of curiosity.</p>

<hr />
<p>Every designer and product manager should use their own products. Not <em>try</em> their own products, but actually <em>use</em> it. It will make your lives easier.</p>

  </div>
  <hr class="thick">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/2015/08/ghost-hack-markdown-in-div">
        Ghost Hack
      </a>
    </h1>

    <span class="post-date">04 Aug 2015</span>

    <p>One of the good things about markdown is it lets you interject HTML in the middle. So far example,</p>

<p>```</p>
<div class="red">I'm red</div>
<p><strong>I‚Äôm bold</strong>
```</p>

<p>Gives you something like:</p>
<div class="red">I'm red</div>
<p><strong>I‚Äôm bold</strong></p>

<hr />

<h2 id="the-problem">The Problem</h2>
<p>Here‚Äôs the problem though, when you are writing in html, you can‚Äôt switch back to Markdown. So for content in a div, you can‚Äôt take care of all the ==cool== <em>markdown</em> styles.</p>

<p>So, for example,</p>

<p>```
<strong>I‚Äôm bold</strong></p>
<div class="red">**I'm not bold, still red though**</div>
<p>```</p>

<p>will give you:</p>

<div class="red">**I'm not bold, still red though**</div>
<p><strong>I‚Äôm bold</strong></p>

<hr />

<h2 id="installation-markdown-in-div-preprocessor">Installation: Markdown-in-Div Preprocessor</h2>

<p>So I made a small Markdown preprocessor. It basically uses img tags to store div info. I use img tags because it doesn‚Äôt require closing tags.</p>

<p>Copy/paste this in after jQuery in the header but before anything that moves around elements or add elements to the HTML.</p>

<p><code>
&lt;script&gt;
    // Markdown In Div
    $(document).ready(function() {
        html = $(".post-content").html().replace(/&lt;img src="start:/g, '&lt;div class="')
            .replace(/&lt;img src="end" alt="" title=""&gt;/g, '&lt;/div&gt;')
        	.replace(/&lt;img src="end" alt=""&gt;/g, "&lt;/div&gt;");
        $(".post-content").html(html);
        $(".post-content").find("div").each(function() {
            class_cleaned = $(this).attr("class").replace("&amp;", " ");
            $(this).attr("class", class_cleaned)
        })
    })
&lt;/script&gt;
</code></p>

<hr />

<h2 id="example-usage">Example Usage</h2>

<p>Now, when you want to open close tag, you can use</p>

<p><code>
 ![](start:red)
 this should be red ==with== *formatting*!
 ![](http://)
</code></p>

<p>This will become:</p>

<p><img src="start:red" alt="" />
 this should be red ==with== <em>formatting</em>!
 <img src="end" alt="" /></p>

<p>ooooo‚Ä¶ Markdown in a Div ~~using~~ hacking the img tag.</p>

<p>Spiffy!</p>

<style>
.red { color: #f00; }
</style>


  </div>
  <hr class="thick">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/2015/08/esp8266-led-using-guide-js">
        Wifi Connected LED using Guide.js
      </a>
    </h1>

    <span class="post-date">02 Aug 2015</span>

    <p>I wasn‚Äôt kidding when I said I‚Äôd use <a href="https://github.com/neuralfirings/guide">Guide.js</a>, my new framework for writing guides and tutorials. Here‚Äôs a rewrite of my ESP8266 to LED tutorial. I think it‚Äôs much neater than the <a href="http://blog.nyl.io/esp8266-led-arduino/">previous version</a>.</p>

<hr />

<div class="guide-step">  
  <div class="guide-main">
<iframe class="imgur-embed" width="100%" height="360" frameborder="0" src="http://i.imgur.com/GfD93zj.gifv#embed"></iframe>
</div>
<div class="guide-text">
<h2 class="guide-title">Ingredients</h2>
<ul><li><a href="http://amzn.to/1Lu6QHu">ESP8266-01 Wifi Module</a></li>
<li><a href="http://amzn.to/1OIMPLp">White LED</a></li>
<li><a href="http://amzn.to/1ISi1tf">FTDI Cable</a></li>
<li><a href="http://amzn.to/1OXGV9W">Lipo 3.7V Battery</a></li>
</ul>

</div>
</div>

<div class="guide-step">  
  <div class="guide-images">
    <img src="http://blog.nyl.io/content/images/2015/07/esp_led_dataflow.png" data-caption="Diagram of Workflow" />
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Workflow</h2>
<ul>
<li>PHP page writes on/off instructions to JSON file based on user input</li>
<li>ESP8266 pings light.json, reads instructions, and turns on/off led&lt;/li&lt;

  




<div class="guide-step">  
  <div class="guide-main">
```
$ sudo nano light.json
$ chmod 755 -R light.json
```
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 1: Create JSON using Shell Scripts</h2>
<ul>
<li>go to the directory of your PHP file</li>
<li>create light.json</li>
<li>assigns permission so index.php can write to it</li>
</ul>
  </div>
</div>

<div class="guide-step">  
  <div class="guide-main">
```
<?php  
$light = $_GET['light'];
if($light == "on") {  
  $file = fopen("light.json", "w") or die("can't open file");
  fwrite($file, '{"light": "on"}');
  fclose($file);
} 
else if ($light == "off") {  
  $file = fopen("light.json", "w") or die("can't open file");
  fwrite($file, '{"light": "off"}');
  fclose($file);
}
?>

<a href="?light=on">Turn On</a>  
<a href="?light=off">Turn Off</a>  
<div>  
  <?php
    if($light=="on") {
      echo("Turn LED on.");
    }
    else if ($light=="off") {
      echo("Turn LED off.");
    }
    else {
      echo ("Do something.");
    }
  ?>
</div>  
```
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 2: PHP <small><a href="https://raw.githubusercontent.com/neuralfirings/esp8266led/master/www/index.php"><i class="fa fa-cloud-download"></i></a></small></h2>

<ul>
<li>Button links to page with url parameters light=on or light=off</li>
<li>PHP looks for URL parameters and writes to light.json</li>
</ul>
  </div>
</div>


<div class="guide-step">  
  <div class="guide-images">
    <img src="http://blog.nyl.io//content/images/2015/08/espled_flashmode.png" data-caption="" />
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 3. Wire Things Up in Flash Mode</h2>
    

<ul>
<li>ESP's VCC &gt; VCC</li>
<li>ESP's CH_PD &gt; VCC</li>
<li>ESP's GND &gt; GND</li>
<li>ESP's RX &gt; FTDI's TX</li>
<li>ESP's TX &gt; FTDI's RX</li>
<li>ESP's GPIO0 &gt; GND<br />(indicate flash mode)</li>
<li>LED's GND &gt; GND</li>
<li>LED's PWR &gt; ESP's GPIO2</li>
</ul>

  </div>
</div>


<div class="guide-step">  
  <div class="guide-images">
    <img src="http://blog.nyl.io/content/images/2015/07/arduino_pref.jpg" data-caption="Install ESP: Preferences" />
    <img src="http://blog.nyl.io/content/images/2015/07/arduino_boardmanagerurl.jpg" data-caption="Install ESP: Add Board Manager URL" />

    <img src="http://blog.nyl.io/content/images/2015/08/arduino_esp_setup.jpg" data-caption="Install ESP: Set Options for ESP8266" />

  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 4. Install ESP in the Arduino IDE</h2>

Install ESP8266 Board
<ul>
<li> Go to preferences</li>
<li> Copy <a href="http://arduino.esp8266.com/package_esp8266com_index.json">this link's url</a> into "Additional Board Manager URLs" box</li>
<li>Click OK</li>
</ul>
Update Settings
<ul>
<li>Board: Generic ESP8266</li>
<li>CPU Frequency: 80 MHz</li>
<li>Flash size: 4M</li>
<li>Upload speed: 115200</li>
<li>Port: my USB port (this shows up once you plugged everything in)</li>
<li>Programmer: AVRISP mkll</li>
</ul>


  </div>
</div>



<div class="guide-step">  
  <div class="guide-main">

```
#include <esp8266wifi.h>
#include <arduinojson.h>

const char* ssid     = "";  
const char* password = "";

const char* host     = ""; // Your domain  
String path          = "/path/to/light.json";  
const int pin        = 2;

void setup() {  
  pinMode(pin, OUTPUT); 
  pinMode(pin, HIGH);
  Serial.begin(115200);

  delay(10);
  Serial.print("Connecting to ");
  Serial.println(ssid);

  WiFi.begin(ssid, password);
  int wifi_ctr = 0;
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }

  Serial.println("WiFi connected");  
  Serial.println("IP address: " + WiFi.localIP());
}

void loop() {  
  Serial.print("connecting to ");
  Serial.println(host);
  WiFiClient client;
  const int httpPort = 80;
  if (!client.connect(host, httpPort)) {
    Serial.println("connection failed");
    return;
  }

  client.print(String("GET ") + path + " HTTP/1.1\r\n" +
               "Host: " + host + "\r\n" + 
               "Connection: keep-alive\r\n\r\n");

  delay(500); // wait for server to respond

  // read response
  String section="header";
  while(client.available()){
    String line = client.readStringUntil('\r');
    // Serial.print(line);
    // we‚Äôll parse the HTML body here
    if (section=="header") { // headers..
      Serial.print(".");
      if (line=="\n") { // skips the empty space at the beginning 
        section="json";
      }
    }
    else if (section=="json") {  // print the good stuff
      section="ignore";
      String result = line.substring(1);

      // Parse JSON
      int size = result.length() + 1;
      char json[size];
      result.toCharArray(json, size);
      StaticJsonBuffer&lt;200&gt; jsonBuffer;
      JsonObject&amp; json_parsed = jsonBuffer.parseObject(json);
      if (!json_parsed.success())
      {
        Serial.println("parseObject() failed");
        return;
      }

      // Make the decision to turn off or on the LED
      if (strcmp(json_parsed["light"], "on") == 0) {
        digitalWrite(pin, HIGH); 
        Serial.println("LED ON");
      }
      else {
        digitalWrite(pin, LOW);
        Serial.println("led off");
      }
    }
  }
  Serial.print("closing connection. ");
}  
```

  
  <div class="guide-text">
    <h2 class="guide-title">Step 5: Arduino Code <small><a href="https://raw.githubusercontent.com/neuralfirings/esp8266led/master/arduino/part2_parseresponse/part2_parseresponse.ino"><i class="fa fa-cloud-download"></i></a></small></h2>


<ul>
<li>Connect to Wifi</li>
<li>Read light.json file</li>
<li>Parse the JSON</li>
<li>Turn on/off LED</li>
</ul>

  </div>





<div class="guide-step">  
  <div class="guide-images">
    <img src="http://blog.nyl.io/content/images/2015/07/esp8266_led_battery_bb.png" data-caption="" />
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 6. Wire Things Up in Run Mode</h2>
    

<ul>
<li>ESP's VCC &gt; VCC</li>
<li>ESP's CH_PD &gt; VCC</li>
<li>ESP's GND &gt; GND</li>
<li>LED's GND &gt; GND</li>
<li>LED's PWR &gt; ESP's GPIO2</li>
</ul>

  </div>
</div>

## Next Steps

There you have it! Not bad. I like it much better than the old, unorganized version. A few things I'd like to add:

* Table of Contents and the ability to link to various sections
* A way to parse this using Markdown, HTML is just... sigh...
* A way to have a carousel of images combined with code, iframes, and other custom elements
* Wrap all the guide-step classes in a guide class, then add things for displaying intro descriptions, ingredients lists, TOC, etc.

Ok. Now go make stuff.
</arduinojson.h></esp8266wifi.h></div></div></li></ul></div></div>

  </div>
  <hr class="thick">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/2015/08/guidejs">
        My Scrappy Guide.js
      </a>
    </h1>

    <span class="post-date">02 Aug 2015</span>

    <p>Project Github Link: https://github.com/neuralfirings/guide</p>

<hr />

<p>Over the past few posts, I‚Äôve written some guides and tutorials on using the <a href="http://blog.nyl.io/tag/esp8266/">ESP8266 chip</a>. People who read it seems to like I would like to continue publishing more of these as I venture into different hardware &amp; software projects.</p>

<p>Some projects I‚Äôd like to try: Internet Controlled Motor (continued), Keychain/Pendant Gameboy emulator, Alternative Reality App, and so on. As I go through these projects, I visit tutorial sites because the internet is how I learn things these days. Oftentimes, it‚Äôs hard to glance and get a good idea of what to do in the tutorials. Even on my own blog, I don‚Äôt think the tutorials and guides I write are that easy to parse.</p>

<p>So I scrapped together <a href="https://github.com/neuralfirings/guide">Guide.js</a> to make it easier to write iFixit style tutorial guide. I like their style. It forces writers to have clear images. The bullets make it seem less intimidating. The layout makes it easy to scroll through and get a rough idea before you dive in.</p>

<h4 id="guide-template-features">Guide Template Features</h4>

<ul>
  <li><strong>iFixit Style Guides</strong>: big images (optional carousel) on the left side and text on the right</li>
  <li><strong>Responsive</strong>: when the screen is smaller, the title bounce above the images and the image becomes full screen</li>
  <li><strong>Extensible Main Feature</strong>: Have a step that doesn‚Äôt involve images? That‚Äôs fine too. You can put whatever you want as the ‚Äúmain feature‚Äù of a given step</li>
</ul>

<h2 id="example-1-simple-image-based-guide">Example 1: Simple Image Based Guide</h2>
<div class="guide-step">
  <div class="guide-images">
    <img src="http://www.nyl.io/guide/01_breadboard.jpg" data-caption="Fritzing Bread Board View" />
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 1</h2>
    <ul>
      <li>Open Fritzing</li>
      <li>Make sure you're in BreadBoard View</li>
      <li>Search for components and drag in to mimic your setup</li>
    </ul>
  </div>
</div>

<div class="guide-step">
  <div class="guide-images">
    <img src="http://www.nyl.io/guide/02a_pcb_airwires.jpg" data-caption="Fritzing PCB View: Airwires" />
    <img src="http://www.nyl.io/guide/02b_pcb_routed.jpg" data-caption="All airwires are routed and board is resized" />
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 2</h2>
    <ul>
      <li>Switch to PCB Tab</li>
      <li>Click on components and use Cmd+R/Ctrl+R to rotate</li>
      <li>You can drag components around by holding down the left mouse button</li>
      <li>Click on the wires to route and add bendpoints</li>
      <li>Resize the board appropriately</li>
    </ul>
  </div>
</div>

<h4 id="the-code">The Code</h4>
<p>```</p>
<div class="guide-step">
  <div class="guide-images">
    <img src="http://www.nyl.io/guide/01_breadboard.jpg" data-caption="Fritzing Bread Board View" />
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 1</h2>
    <ul>
      <li>Open Fritzing</li>
      <li>Make sure you're in BreadBoard View</li>
      <li>Search for components and drag in to mimic your setup</li>
    </ul>
  </div>
</div>

<div class="guide-step">
  <div class="guide-images">
    <img src="http://www.nyl.io/guide/02a_pcb_airwires.jpg" data-caption="Fritzing PCB View: Airwires" />
    <img src="http://www.nyl.io/guide/02b_pcb_routed.jpg" data-caption="All airwires are routed and board is resized" />
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 2</h2>
    <ul>
      <li>Switch to PCB Tab</li>
      <li>Click on components and use Cmd+R/Ctrl+R to rotate</li>
      <li>You can drag components around by holding down the left mouse button</li>
      <li>Click on the wires to route and add bendpoints</li>
      <li>Resize the board appropriately</li>
    </ul>
  </div>
</div>
<p>```</p>

<h2 id="example-2-using-different-main-components">Example 2: Using different Main Components</h2>

<p>If you want something more complex, you can also use the <code>guide-main</code> class to put in any random thing, like code blocks or presentations (which I do using <a href="https://github.com/impress/impress.js">Impress.js</a>‚Ä¶ well, a hacked version I made with some added features like captioning).</p>

<div class="guide-step">
  <div class="guide-main">
    <pre>
      <code>
var ua = navigator.userAgent.toLowerCase();
if(ua.search(/(iphone)|(ipod)|(android)/) != -1) {
  $(".not-for-mobile").hide();
  $(".for-mobile").show();
}
else {
  $(".not-for-mobile").show();
  $(".for-mobile").hide();
}  
      </code>
    </pre>
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 1: Some title</h2>
    Here are some example code as the main feature. 
  </div>
</div>
<div class="guide-step">
  <div class="guide-main">
    <div class="for-mobile">
    <a target="_blank" href="http://nyl.io/impress/espmotor.html?mobile=on"><img src="http://nyl.io/impress/espmotor.png" /></a>
    </div>

    <div class="not-for-mobile" style="position:relative; padding-bottom: 75%; padding-top: 25px; ">
    <iframe class="macdown-hide" frameborder="0" src="http://nyl.io/impress/espmotor.html" style="position: absolute; top:0; left:0; width: 100%; height: 100%"></iframe></div>
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 2: Some other title</h2>
    <p>This is something made with impress.js.. well, a hacked version made for presenting with captions and some tweaked for mobile "support."</p>
    <div class="for-mobile">
      Click on the diagram on the left to go through the workflow. It will open up a new page. Once you are on the new page, click on the RIGHT SIDE of the screen to go forward, and click on the LEFT SIDE of the screen to go back. 
    </div>
    <div class="not-for-mobile">
      Click on the diagram on the left to go through the workflow.
    </div>
  </div>
</div>

<h4 id="the-code-1">The Code</h4>
<p>```</p>
<div class="guide-step">
  <div class="guide-main">
    <pre>
      <code>
var ua = navigator.userAgent.toLowerCase();
if(ua.search(/(iphone)|(ipod)|(android)/) != -1) {
  $(".not-for-mobile").hide();
  $(".for-mobile").show();
}
else {
  $(".not-for-mobile").show();
  $(".for-mobile").hide();
}  
      </code>
    </pre>
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 1: Some title</h2>
    Here are some example code as the main feature. 
  </div>
</div>
<div class="guide-step">
  <div class="guide-main">
    <div class="for-mobile">
    <a target="_blank" href="http://nyl.io/impress/espmotor.html?mobile=on"><img src="http://nyl.io/impress/espmotor.png" /></a>
    </div>

    <div class="not-for-mobile" style="position:relative; padding-bottom: 75%; padding-top: 25px; ">
    <iframe class="macdown-hide" frameborder="0" src="http://nyl.io/impress/espmotor.html" style="position: absolute; top:0; left:0; width: 100%; height: 100%"></iframe></div>
  </div>
  <div class="guide-text">
    <h2 class="guide-title">Step 2: Some other title</h2>
    <p>This is something made with impress.js.. well, a hacked version made for presenting with captions and some tweaked for mobile "support."</p>
    <div class="for-mobile">
      Click on the diagram on the left to go through the workflow. It will open up a new page. Once you are on the new page, click on the RIGHT SIDE of the screen to go forward, and click on the LEFT SIDE of the screen to go back. 
    </div>
    <div class="not-for-mobile">
      Click on the diagram on the left to go through the workflow.
    </div>
  </div>
</div>
<p>```</p>

<h2 id="next-steps">Next Steps</h2>

<p>I will use <a href="https://github.com/neuralfirings/guide">Guide.js</a> to write guides for this blog going forward, and maybe write a Guide to the Guide. Hehe. If I want to get really fancy, create some sort of a Markdown conversion since my blog is written using Markdown.</p>

  </div>
  <hr class="thick">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/2015/07/pcbs-misbehaving">
        PCBs Misbehaving
      </a>
    </h1>

    <span class="post-date">26 Jul 2015</span>

    <p>I got my custom PCBs from iTEAD last week. So exciting, right?</p>

<p><img src="/content/images/2015/07/pcbmotor_pcbs.jpg" alt="" /></p>

<p>I plugged everything in and‚Ä¶. WARHN warhn (failure horn üì¢).</p>

<p><img src="/content/images/2015/07/failwhale.jpg" alt="" /></p>

<h2 id="problem">Problem</h2>

<p>So much trouble trying to figure out what‚Äôs the issue. The LED would sometimes turn on, sometimes it wouldn‚Äôt, sometimes the LED would turn on and stay on. I think this indicated that the ESP8266 was frozen. The motor would work maybe 10% of the time. And it was all completely random. I checked my soldering for loose connections. Resoldered a few suspicious (but I think they were fine) connections. Poke and prodded this little green thing with my <a href="http://amzn.to/1MuPvhT">multimeter</a>.</p>

<h2 id="root-cause-i-think-maybe">Root Cause (I think? Maybe?)</h2>

<p>I suspect it‚Äôs had something to do with my 5V Regulator. It seems to be working off a lot of heat. I didn‚Äôt have a heat sink for it. Trying to debug it let me all over the place. Sometimes it would give me a steady 5V (or 4.9V), other times it would putt along at a 4.2V. I suspect this might be because my 9V battery was losing too much juice too quickly. The 5V Regulator I used (<a href="https://www.adafruit.com/products/2164">7805 TO-220</a>) needs a minimum of 7V to output a consistent 5V, according to Adafruit product description. So 4.2V output is no go since the L293D motor driver has a minimum supply voltage of 4.5V (and a max of 36!) so that was a no go.</p>

<p>The other problem was my LED. I got some LED that came with built in resistors, but I think when I soldered them in I soldered them above where the resistor were. So I had to redo the LED. I used a handy white LED the second time since white LEDs have the highest forward voltage. I ended up tearing up the copper traces during this ‚Äúfix‚Äù and had to solder in wires manually (see pic below).</p>

<h2 id="solution-ish">Solution (ish)</h2>

<p>To solve the 5V Regulator problem I decided to just F it and use a different battery pack. I got out my handy 4 AA battery. This starts at a 6V and works its way down to a 4.4V. With a fresh set of batteries it‚Äôs a little too high for the ATtiny85 chip, which has a max supply voltage of 5.5V. However, it doesn‚Äôt stay at 6V for long and the batteries I‚Äôm using is definitely not at 6V. I then added a manual wire connection between the Input on the 5V regulator and the VCC on the L293D chip. Basically, I bypassed the 5V regulator and plugged the power source directly onto the ATtiny85 and L293D Motor Driver.</p>

<p><img src="/content/images/2015/07/pcbmotor_hack_comments.jpg" alt="" /></p>

<p>It‚Äôs probably not the safest or the smartest thing to do. BUT IT WORKS! It‚Äôs so beautiful it works. And it‚Äôs tidy.</p>

<p><strong>Before (breadboard):</strong>
<img src="/content/images/2015/07/pcbmotor_prepcb.jpg" alt="" /></p>

<p><strong>After (custom PCB):</strong>
<img src="/content/images/2015/07/pcbmotor_setup.jpg" alt="" /></p>

<p>So tidy. Much tiny.</p>

<h2 id="next-steps">Next Steps</h2>

<p>To get these components in their comfortable range of operation, I‚Äôll try routing the ESP8266 (&amp; LED) and ATtiny85 through a 3V Regulator and leave the L293D Motor Driver (&amp; Stepper Motor) directly connected to the 9V Battery.</p>

<table style="font-size: 0.7em">
<tr><th>Component</th><th>Min Supply Voltage</th><th>Max Supply Voltage</th><th>Current Power</th><th>Proposed Power</th></tr>
<tr><td>ESP8266</td><td>3.3V</td><td>3.6V</td>&lt;td colspan=2 style="text-align: center"&gt;3V Regulator</tr>
<tr><td>LED</td><td>2.5V</td><td>3.2V</td>&lt;td colspan=2 style="text-align: center"&gt;ESP8266 (3.2 V on HIGH)</tr>
<tr><td>ATtiny85</td><td>1.8V</td><td>5.5V</td><td>5V Regulator</td><td>3V Regulator</td></tr>
<tr><td>L293D Motor Driver</td><td>4.6V</td><td>36V</td><td>5V Regulator</td><td>Battery (4.4-9V)</td></tr>
<tr><td>Stepper Motor</td><td>5V</td><td>5V</td>&lt;td colspan=2 style="text-align: center"&gt;L293D</tr>
</table>

<h2 id="also-next-steps">Also Next Steps</h2>

<p>Rather than waiting another two weeks to get a PCB, I‚Äôm researching how to etch my own PCB at home. It seems like a huge hassle, but I figure it‚Äôs probably worth being able to rapidly prototyping board after board.</p>

<p>The problem is I‚Äôm woefully undersupply. I looked into it, and I‚Äôll need something like:</p>

<ul>
  <li>Drill press (for the through holes and vias)</li>
  <li>Feric Chloride (sp?) for etching away the copper</li>
  <li>FR4 Copper Boards</li>
  <li>Safety stuff: gloves, goggles, work mask</li>
  <li>Laser printer (or more chemicals that I‚Äôll probably splash on things I shouldn‚Äôt splash weird chemicals on. Like <a href="http://ajaxthedog.com">my dog</a>)</li>
  <li>Some tool to cut the FR4 material</li>
</ul>

<p>If I want to get fancy, I might need:</p>

<ul>
  <li>Laminator</li>
  <li>A bunch of sheets that does fancy transfer things</li>
</ul>

<p>Seems like a lot of stuff.</p>

<p>Is it worth it?</p>

  </div>
  <hr class="thick">
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/blog/page3">Older</a>
  
  
    
      <a class="pagination-item newer" href="/blog/">Newer</a>
    
  
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
